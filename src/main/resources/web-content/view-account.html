<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Account Details</title>
    <link rel="stylesheet" href="account.css">
</head>

<body>
    <div style="padding-left : 20px">
        <div class="label">Balance:  <span class="value" id="balance"></span></div>
        <div style="clear:both"></div>
        <div><a class="button-link" href="purchase.html">Buy</a></div>
    </div>

    <div>
        <table id="transactionTable">
        </table>
    </div>

</body>

<script src="account.js"></script>
<script src="handlebars-v4.0.5.js"></script>

<script id="transaction-template" type="text/x-handlebars-template">
    <tr>
        <td>{{description}}</td>
        <td>{{postedDate}}</td>
        <td>{{amount}}</td>
    </tr>
</script>

<script>
    function balanceUpdated(balance) {
        document.getElementById("balance").innerHTML = balance;
    }

    function transactionsUpdated(transactions) {
        var source   = document.getElementById('transaction-template').innerHTML;
        var template = Handlebars.compile(source);
        var transactionTrs = "<tr><th>Description</th><th>Date</th><th>Amount</th></tr>";
        for (i = 0; i < transactions.length; i++) {
            transactionTrs += template(transactions[i]);
        }
        document.getElementById('transactionTable').innerHTML = transactionTrs;
    }

    window.onload = function () {
        retrieveBalance(balanceUpdated);
        retrieveTransactions(transactionsUpdated);
    };
</script>
</html>